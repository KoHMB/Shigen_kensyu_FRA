CV=0.4 
N=c(10^3,10^4,10^5,10^6,10^7,10^8)
x=(N)^0.5/CV
floor(x) # 指定したCVのもとで必要となる捕獲数の出力

#-------------------
M = n = 50000 # 捕獲数と再捕獲数は同じと仮定
N = 10^8 # 資源尾数
m = rhyper(1000, M, N-M, n) # 1000回の試行
N_est = (M-1)*(n-1)/(m+1) # m=0だと困るので分母に+1
par(mfrow=c(1,2)) 
hist(m, breaks=seq(0,50,1)) # 再捕獲数のヒストグラム
hist(N_est, breaks=seq(0,10*N,N/10)) # 推定値のヒストグラム
abline(v=N,col="red") # 真の資源尾数の位置を赤い線で表示 
par(mfrow=c(1,1)) 
cat("Nest =",mean(N_est),"\n") # 推定値の平均を表示
